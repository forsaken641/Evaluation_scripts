void Gobby::EditCommands::on_active_user_changed(InfUser* active_user)
{
	g_assert(m_current_view != NULL);

	if(active_user != NULL)
	{
		InfTextSession* session = m_current_view->get_session();
		InfAdoptedAlgorithm* algorithm =
			inf_adopted_session_get_algorithm(
				INF_ADOPTED_SESSION(session));
		GtkTextBuffer* buffer = GTK_TEXT_BUFFER(
			m_current_view->get_text_buffer());

		m_actions.undo->set_enabled(
			inf_adopted_algorithm_can_undo(
				algorithm, INF_ADOPTED_USER(active_user)));
		m_actions.redo->set_enabled(
			inf_adopted_algorithm_can_redo(
				algorithm, INF_ADOPTED_USER(active_user)));

		m_actions.cut->set_enabled(
			gtk_text_buffer_get_has_selection(buffer));
		m_actions.paste->set_enabled(true);
	}
	else
	{
		m_actions.undo->set_enabled(false);
		m_actions.redo->set_enabled(false);
		m_actions.cut->set_enabled(false);
		m_actions.paste->set_enabled(false);
	}
}
