diff --git a/src/wasm/wasm-binary.cpp b/src/wasm/wasm-binary.cpp
index 985a38be5b2..ac68cbe566d 100644
--- a/src/wasm/wasm-binary.cpp
+++ b/src/wasm/wasm-binary.cpp
@@ -1505,6 +1505,9 @@ void WasmBinaryBuilder::processFunctions() {
     auto index = exportIndexes[curr];
     switch (curr->kind) {
       case ExternalKind::Function: {
+        if (index >= wasm.functions.size()) {
+          throwError("bad function export index");
+        }
         curr->value = getFunctionIndexName(index);
         break;
       }
