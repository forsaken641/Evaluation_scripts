diff --git a/src/decode_r2007.c b/src/decode_r2007.c
index 7b94daecfd..91e75e1f8d 100644
--- a/src/decode_r2007.c
+++ b/src/decode_r2007.c
@@ -1308,6 +1308,9 @@ obj_string_stream (Bit_Chain *restrict dat, Dwg_Object *restrict obj,
   if (str->byte >= old_size - old_byte)
     {
       LOG_WARN ("obj_string_stream overflow");
+      str->byte = old_byte;
+      str->size = old_size;
+      obj->has_strings = 0;
       return DWG_ERR_VALUEOUTOFBOUNDS;
     }
   LOG_HANDLE (" obj string stream +%u: @%lu.%u (%lu)", start, str->byte,
