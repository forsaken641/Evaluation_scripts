diff --git a/libfreerdp/core/security.c b/libfreerdp/core/security.c
index 8511d8d0ab..83298fdd1b 100644
--- a/libfreerdp/core/security.c
+++ b/libfreerdp/core/security.c
@@ -492,6 +492,8 @@ BOOL security_encrypt(BYTE* data, int length, rdpRdp* rdp)
 
 BOOL security_decrypt(BYTE* data, int length, rdpRdp* rdp)
 {
+	if (rdp->rc4_decrypt_key == NULL)
+		return FALSE;
 	if (rdp->decrypt_use_count >= 4096)
 	{
 		security_key_update(rdp->decrypt_key, rdp->decrypt_update_key, rdp->rc4_key_len);
