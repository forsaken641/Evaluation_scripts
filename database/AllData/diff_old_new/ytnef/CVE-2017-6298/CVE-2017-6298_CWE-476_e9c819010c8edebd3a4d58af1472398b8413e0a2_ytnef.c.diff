diff --git a/lib/ytnef.c b/lib/ytnef.c
index 78881b8..a2e6713 100644
--- a/lib/ytnef.c
+++ b/lib/ytnef.c
@@ -1462,6 +1462,9 @@ int IsCompressedRTF(variableLength *p) {
   BYTE *src;
   ULONG magic;
 
+  if (p->size < 4)
+    return 0;
+
   src = p->data;
   in = 0;
 
